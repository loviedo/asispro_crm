<!--
including header content which is common for all pages
-->
<%- include ../layouts/header.ejs %>
 
<% if (messages.error) { %>
    <p style="color:red"><%- messages.error %></p>
<% } %>
 
<% if (messages.success) { %>
    <p style="color:green"><%- messages.success %></p>
<% } %>    

<!-- funcion para arreglar el formato de las fechas -->
<%
function formatear_fecha(date) {
    var d = new Date(date),
        month = '' + (d.getMonth() + 1),
        day = '' + d.getDate(),
        year = d.getFullYear();

    if (month.length < 2) month = '0' + month;
    if (day.length < 2) day = '0' + day;

    return [day,month,year].join('/');//retornamos valor como a mysql le gusta
}
%>

<style>
table {
  width: 500px;
}

.scroll {
  max-height: 700px;
  overflow: auto;
}
</style>

<!-- NAV PARA TITULO -->
<nav class="navbar navbar-expand-lg navbar-light bg-light" style="background:#000000;">
    <div class="container-fluid">
        <h3>Listado de Ã“rdenes de Trabajo</h3>
    </div>
</nav>

<nav class="navbar navbar-expand-lg navbar-light bg-light" >
    <div class="container-fluid" style="height: 400px;"><!-- modificar el estilo y el color -- verificar como se muestra -->

        <!-- <table width='90%' border=0 > -->
        <div class="scroll">
        <table class="table table-sm table-hover">
            <tr style='text-align:left; background-color:#CCC'>
                <th>Nro OT</th>
                <th>FECHA EMISION</th>
                <th>F INI EJECUCION</th>
                <th>F FIN EJECUCION</th>
                <th>Nro FACTURA</th>
                <th>Est FACTURA</th>
                <th>Nro RECIBO</th>
                <th>No REMISION</th>
                <th>TTIPO FACTURA</th>
                <th>CLIENTE</th>
                <th>OBRA</th>
                <th>DESCRIPCION</th>
                <th>  </th><!-- PARA LAS COLUMNAS DE  -->
            </tr>

            <% if (data) { %>
            <% data.forEach(function(ot){ %>
                <tr>
                    <td><%= ot.ot_nro %></td>
                    <td><%= formatear_fecha(ot.fec_emision) %></td>
                    <td><%= formatear_fecha(ot.fec_ini_ejecucion) %></td>
                    <td><%= formatear_fecha(ot.fec_fin_ejecucion) %></td>
                    <td><%= ot.fact_nro %></td>
                    <td><%= ot.fact_estado %></td>
                    <td><%= ot.recibo_nro %></td>
                    <td><%= ot.remision_nro %></td>
                    <td><%= ot.fact_tipo %></td>
                    <td><%= ot.cliente %></td>
                    <td><%= ot.obra %></td>
                    <td><%= ot.descripcion %></td>
                    <td>
                        <div style="float:left">
                            <a href='/ot/editar/<%= ot.id %>'>Editar</a> &nbsp;                            
                            <form method="post" action="/ot/eliminar/<%= ot.id %>" style="float:right">
                                <input type="submit" name="delete" value='Delete' onClick="return confirm('Seguro que desea borrar la factura?')" />
                                <input type="hidden" name="_method" value="DELETE" />
                            </form>
                        </div>
                    </td>
                </tr>
            <% }) %>
            <% } %>
        </table></div>
    </div>
</nav>
<!-- BOTONES DE EXPORTACION -->
<nav class="navbar navbar-expand-lg navbar-light bg-strong">
    <div class="container-fluid">
        <button type="button" id="expotar" class="btn btn-info">
            <i class="fas fa-share"></i>
        </button>
    </div>
</nav>
<!--
including footer content which is common for all pages
-->
<%- include ../layouts/footer.ejs %>